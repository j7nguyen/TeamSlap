<div class="container">
	<h2><%= @user.first_name %> <%= @user.last_name %></h2>
	<p>Email address: <%= @user.email %></p>
	<p>Gender: <%= @user.gender %></p>

	<% if @user.owned_teams %>
	<p>Teams I Manage:</p>
	<ul>
		<% @user.owned_teams.each do |team| %>
		<li><%= link_to team.name, team_url(team) %></li>
		<% end %>
	</ul>
	<% end %>

	<% if @user.teams %>
	<% user_games = []%>
	<p>Teams I Play On:</p>
	<ul>
		<% @user.teams.each do |team| %>
			<% team.games.each { |game| user_games.push(game) } if team.games %>
			<li><%= link_to team.name, team_url(team) %></li>
		<% end %>
	</ul>

	<h3>My Games</h3>

	<% if !(user_games.empty?) %>
	<table class="table table-striped table-bordered">
		<tr>
			<th>League</th>
			<th>Date</th>
			<th>Time</th>
			<th>Home Team</th>
			<th>Away Team</th>
			<th>Location</th>
			<th>Result</th>
			<th>Availability</th>
		</tr>

		<% user_games.each do |game| %>
		<tr id="game_<%= game.id %>">
			<td><%= game.league.name %></td>
			<td><%= game.date %></td>
			<td><%= game.time %></td>
			<td><%= game.home_team.name %></td>
			<td><%= game.away_team.name %></td>
			<td><%= game.location.name %></td>
			<td><%= game.result %></td>
			<% player_avail = @user.availability(game) %>

				<% if @user == current_user %>
						<td class="editable-availability" id='<%= player_avail.id %>'
							data-toggle="modal" data-target='#availModal'>
				<% else %>
						<td class="availability" id='<%= player_avail.id %>'>
				<% end %>
				<%= player_avail.avail_button %>
			</td>
		</tr>
			<% end %>
			</table>
	<% end %>
<% end %>

<div class="modal fade" id="availModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Edit Availability</h4>
      </div>
      <div class="modal-body">
        ...
      </div>
      <!-- <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div> -->
    </div>
  </div>
</div>
	
<script>
// $('.editable-availability').css('cursor', 'pointer');
$('.editable-availability').on('click', function(event) {
	event.preventDefault();
	var availId = this.id;
	var userId = <%= @user.id %>;
	chooseAvail(availId, userId);
});


</script>

	

	<p><%= link_to "Edit User Information", edit_user_url(@user)%></p>

</div>

<div class="container">
	<h2><%= @user.first_name %> <%= @user.last_name %></h2>
	<p>Email address: <%= @user.email %></p>
	<p>Gender: <%= @user.gender %></p>

	<% if @user.owned_teams %>
	<p>Teams I Manage:</p>
	<ul>
		<% @user.owned_teams.each do |team| %>
		<li><%= link_to team.name, team_url(team) %></li>
		<% end %>
	</ul>
	<% end %>

	<% if @user.teams %>
	<% user_games = []%>
	<p>Teams I Play On:</p>
	<ul>
		<% @user.teams.each do |team| %>
			<% team.games.each { |game| user_games.push(game) } if team.games %>
			<li><%= link_to team.name, team_url(team) %></li>
		<% end %>
	</ul>

	<h3>My Games</h3>
	<% if !(user_games.empty?) %>
	<table class="table table-striped table-bordered">
		<tr>
			<th>League</th>
			<th>Date</th>
			<th>Time</th>
			<th>Home Team</th>
			<th>Away Team</th>
			<th>Location</th>
			<th>Result</th>
			<th>Availability</th>
		</tr>

		<% user_games.each do |game| %>
		<tr id="game_<%= game.id %>">
			<td><%= game.league.name %></td>
			<td><%= game.date %></td>
			<td><%= game.time %></td>
			<td><%= game.home_team.name %></td>
			<td><%= game.away_team.name %></td>
			<td><%= game.location.name %></td>
			<td><%= game.result %></td>
			<% player_avail = Availability.where({player_id: @user.id, game_id: game.id })[0] %>

				<% if @user == current_user %>
						<td class="editable-availability" id='<%= player_avail.id %>'>
				<% else %>
						<td class="availability" id='<%= player_avail.id %>'>
				<% end %>
				<%= player_avail.avail_string %>
			</td>
		</tr>
			<% end %>
			</table>
	<% end %>
<% end %>
	
<script>
$('.editable-availability').on('dblclick', function() {
	var availId = this.id;
	var userId = <%= @user.id %>;
	chooseAvail(availId, userId);
});


</script>

	

	<p><%= link_to "Edit User Information", edit_user_url(@user)%></p>

</div>


<% team = Team.find(params[:id]) %>
<div class="row">
	<div class="col-xs-6 col-xs-offset-1">
		<h2><%= team.name %></h2>
		<p>Sport: <%= team.sport.name %></p>
		<p>Manager: <%= team.manager.first_name %> <%= team.manager.last_name%></p>
		<p>League(s):</p>
		<ul>
			<% team.leagues.each do |league| %>
			<li><%= link_to league.name, league_url(league) %></li>
			<% end %>
		</ul>
	</div>
</div>

<div class="row">
	<div class="col-xs-6 col-xs-offset-1">
<h3>Roster</h3>
<table class="roster table table-striped table-bordered">
	<tr>
		<th>First Name</th>
		<th>Last Name</th>
		<th>Gender</th>

	</tr>


	<% team.roster_adds.each do |roster_add| %>
	
	<tr>
		<td><%= roster_add.user.first_name %></td>
		<td><%= roster_add.user.last_name %></td>
		<td><%= roster_add.user.gender %></td>
		<% if current_user.id == team.manager_id%>
		<td><button class='delete-player btn btn-danger' value="<%= roster_add.id %>">
			Delete Player</button></td>
		<% end %>
	</tr>
	<% end %>
</table>
	</div> 
</div>
<script>
$('.roster').on('click', 'button', function() {
	var rosterAddId = this.value;
	$(this).parent().parent()[0].remove();
	playerRemove(rosterAddId, <%= team.id %>);
});
</script>

<% if current_user.id == team.manager_id %>
<div class="row">
	<div class="col-xs-6 col-xs-offset-1">
		
	<p>Add a Player to the Roster:</p>
	

	
<form id="add_player" >
	<%= auth_token_input %>
	<label>Other Registered Players
		<select name="roster[player_id]" id="available-players">
			<% @non_roster_players.each do |player| %>
				<option id='option-<%=player.id%>' value="<%=player.id %>">
					<%= player.name %>
				</option>
			<% end %>
		</select>
	</label>

	<input type="hidden" name="roster[team_id]" 
		value="<%= params[:id] %>">
	<input type="submit" value="Add Player">
</form>	
</div>
</div>
<% end %>
<script>
	$('#add_player').on('submit', function(event) {
		event.preventDefault();
		var playerId = $("#available-players").val();
		var formData = {roster: {
			player_id: playerId,
			team_id: <%= team.id %>
		}}
		playerAdd(formData, <%= team.id %>, playerId);
	});
</script>

<div class="row">
	<div class="col-xs-6 col-xs-offset-1">
<p><%= link_to "Back to all teams", teams_url %></p>
</div>